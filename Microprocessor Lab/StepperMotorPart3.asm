CODE SEGMENT
ASSUME CS:CODE
ORG 1000H

START:

MOV DX, 0FF2BH
MOV AL, 82H
OUT DX, AL

MOV BL, 88H

L1:
MOV DX, 0FF29H
IN AL, DX
AND AL, 3H
MOV BH, AL
MOV CX, 512

CMP AL, 2
JE L2
CMP AL, 1
JE L3
JMP L1

L2:
ROL BL, 1
JMP CONT

L3:
ROR BL, 1
JMP CONT

CONT:
MOV DX, 0FF28H
MOV AL, BL
OUT DX, AL
PUSH CX
CALL DELAY
POP CX

DEC CX
CMP CX, 0
JE L1

MOV DX, 0FF29H
IN AL, DX
AND AL, 3H
CMP AL, 3
JE L4
CMP AL, BH
JNE L1
L4:
CMP BH, 2
JE L2
CMP BH, 1
JE L3

DELAY PROC NEAR
      MOV CX, 500
      LD:
      NOP
      LOOP LD
      RET
DELAY ENDP

END START
CODE ENDS
